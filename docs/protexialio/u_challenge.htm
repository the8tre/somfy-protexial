<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <meta http-equiv="content-style-type" content="text/css"/>
        <title>Centrale &nbsp;:&nbsp;Utilisateur</title>
        <link rel="shortcut icon" href="/domis.ico" type="image/x-icon"/>
        <meta name="language" content="fr"/>
        <meta http-equiv="expires" content="0">
        <meta http-equiv="pragma" content="no-cache">
        <meta http-equiv="cache-control" content="no-cache, must-revalidate">
        <link href="/domis_user.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="/js/ajax.js"></script>
    </head>
    <body onLoad="allowAJAX=true;" onUnload="allowAJAX=false;">
        <div id="page">
            <div id="fond">
                <div id="menu">
                    <div class="logohmb">&nbsp;</div>
                    <div id="filler">&nbsp;</div>
                    <a class="menuvoid" href="u_pilotage.htm">Piloter mon alarme et mes automatismes</a>
                    <a class="menuvoid" href="u_regcam.htm">Mes images</a>
                    <a class="menuvoid" href="u_listelmt.htm">Liste des éléments</a>
                    <a class="menuvoid" href="journal.htm">Journal des évènements</a>
                    <a class="menuvoid" href="u_regqck.htm">Réglages rapides</a>
                    <a class="menuvoid" href="regalm.htm">Réglage mise sous alarme</a>
                    <a class="menuvoid" href="u_regvol.htm">Réglage volets roulants</a>
                    <a class="menuvoid" href="u_reglum.htm">Réglage lumières</a>
                    <a class="menuvoid" href="u_challenge.htm">Carte d'authentification</a>
                </div>
                <div id="navbar">
                    <div id="mode">Utilisateur</div>
                    <div id="disconnect">
                        <a href="/logout.htm">Deconnexion</a>
                    </div>
                    <div id="refresh">
                        <a href="javascript:location.reload(true)">Actualiser</a>
                    </div>
                </div>
                <div id="titlebar">
                    <div class="titlevoid">Carte d'authentification</div>
                    <div class="titlecorner"></div>
                    <script type="text/javascript" charset="UTF-8">
                        function updateStatus(xmlData) {
                            // Loop over all the group
                            for (i = 0; i < 3; i++) {
                                if (getXMLValue(xmlData, 'zone' + i) == 'on') {
                                    document.getElementById('zone' + i).className = 'zone' + i + '_on';
                                } else if (getXMLValue(xmlData, 'zone' + i) == 'off') {
                                    document.getElementById('zone' + i).className = 'zone' + i + '_off';
                                }
                            }
                            // Loop over all the Defaults
                            for (i = 0; i < 5; i++) {
                                if (getXMLValue(xmlData, 'defaut' + i) == 'ok') {
                                    document.getElementById('defaut' + i).className = 'defaut' + i + '_ok';
                                } else if (getXMLValue(xmlData, 'defaut' + i) == 'nok') {
                                    document.getElementById('defaut' + i).className = 'defaut' + i + '_nok';
                                }/*Specific case for intrusion detection*/
                                else if (getXMLValue(xmlData, 'defaut' + i) == 'nok_int') {
                                    document.getElementById('defaut' + i).className = 'defaut' + i + '_intrusion';
                                }/*Specific case for domestic default detection*/
                                else if (getXMLValue(xmlData, 'defaut' + i) == 'nok_dom') {
                                    document.getElementById('defaut' + i).className = 'defaut' + i + '_domestic';
                                }
                            }

                            // GSM management
                            if (document.getElementById('operator_gsm') != null) {
                                document.getElementById('operator_gsm').innerHTML = getXMLValue(xmlData, 'opegsm');
                            }
                            if (document.getElementById('status_gsm') != null) {
                                document.getElementById('status_gsm').innerHTML = getXMLValue(xmlData, 'gsm');
                            }

                            // GSM radio reception level indicator 
                            if (getXMLValue(xmlData, 'recgsm') == '0') {
                                document.getElementById('recgsm').className = 'recgsm_0_ok';
                            } else if (getXMLValue(xmlData, 'recgsm') == '1') {
                                document.getElementById('recgsm').className = 'recgsm_1_ok';
                            } else if (getXMLValue(xmlData, 'recgsm') == '2') {
                                document.getElementById('recgsm').className = 'recgsm_2_ok';
                            } else if (getXMLValue(xmlData, 'recgsm') == '3') {
                                document.getElementById('recgsm').className = 'recgsm_3_ok';
                            } else if (getXMLValue(xmlData, 'recgsm') == '4') {
                                document.getElementById('recgsm').className = 'recgsm_4_ok';
                            } else if (getXMLValue(xmlData, 'recgsm') == '5') {
                                document.getElementById('recgsm').className = 'recgsm_5_ok';
                            } else if (getXMLValue(xmlData, 'recgsm') == 'k0') {
                                document.getElementById('recgsm').className = 'recgsm_0_nok';
                            } else if (getXMLValue(xmlData, 'recgsm') == 'k1') {
                                document.getElementById('recgsm').className = 'recgsm_1_nok';
                            } else if (getXMLValue(xmlData, 'recgsm') == 'k2') {
                                document.getElementById('recgsm').className = 'recgsm_2_nok';
                            } else if (getXMLValue(xmlData, 'recgsm') == 'k3') {
                                document.getElementById('recgsm').className = 'recgsm_3_nok';
                            } else if (getXMLValue(xmlData, 'recgsm') == 'k4') {
                                document.getElementById('recgsm').className = 'recgsm_4_nok';
                            } else if (getXMLValue(xmlData, 'recgsm') == 'k5') {
                                document.getElementById('recgsm').className = 'recgsm_5_nok';
                            } else if (getXMLValue(xmlData, 'recgsm') == 'missing') {
                                document.getElementById('recgsm').className = 'recgsm_off';
                            }

                            // Axis cameras status 
                            if (getXMLValue(xmlData, 'camera') == 'ok') {
                                document.getElementById('camera').className = 'camera_ok';
                            } else if (getXMLValue(xmlData, 'camera') == 'ko') {
                                document.getElementById('camera').className = 'camera_ko';
                            } else if (getXMLValue(xmlData, 'camera') == 'disabled') {
                                document.getElementById('camera').className = 'no_camera';
                            }
                        }
                        setTimeout("newAJAXCommand('/status.xml', updateStatus, true, '')", 500);
                    </script>
                    <div id="pictobar">
                        <!-- group A -->
                        <div id="zone0" class="zone_dis">&nbsp;</div>
                        <!-- group B -->
                        <div id="zone1" class="zone_dis">&nbsp;</div>
                        <!-- group C -->
                        <div id="zone2" class="zone_dis">&nbsp;</div>
                        <!-- Battery default -->
                        <div id="defaut0" class="defaut_dis">&nbsp;</div>
                        <!-- Communication default -->
                        <div id="defaut1" class="defaut_dis">&nbsp;</div>
                        <!-- Door default -->
                        <div id="defaut2" class="defaut_dis">&nbsp;</div>
                        <!-- House default -->
                        <div id="defaut3" class="defaut_dis">&nbsp;</div>
                        <!-- Box open default -->
                        <div id="defaut4" class="defaut_dis">&nbsp;</div>
                        <!-- GSM radio reception level indicator -->
                        <div id="recgsm" class="defaut_dis">&nbsp;</div>
                        <!-- Axis Camera status -->
                        <div id="camera" class="camera_disabled">&nbsp;</div>
                    </div>
                </div>
                <div id="content" class="contentall">
                    <div class="textcontent">
                        <form method="post" action="u_challenge.htm" name="u_challenge">
                            <table id="keycard">
                                <tr>
                                    <td class="notvisible">&nbsp;</td>
                                    <td class="keycardfond">A</td>
                                    <td class="keycardfond">B</td>
                                    <td class="keycardfond">C</td>
                                    <td class="keycardfond">D</td>
                                    <td class="keycardfond">E</td>
                                    <td class="keycardfond">F</td>
                                </tr>
                                <tr>
                                    <td class="keycardfond">1</td>
                                    <td>4667</td>
                                    <td>6841</td>
                                    <td>6149</td>
                                    <td>7771</td>
                                    <td>0367</td>
                                    <td>5341</td>
                                </tr>
                                <tr>
                                    <td class="keycardfond">2</td>
                                    <td>4809</td>
                                    <td>1519</td>
                                    <td>4915</td>
                                    <td>5745</td>
                                    <td>5997</td>
                                    <td>3011</td>
                                </tr>
                                <tr>
                                    <td class="keycardfond">3</td>
                                    <td>8551</td>
                                    <td>4085</td>
                                    <td>9105</td>
                                    <td>4663</td>
                                    <td>8747</td>
                                    <td>5769</td>
                                </tr>
                                <tr>
                                    <td class="keycardfond">4</td>
                                    <td>0757</td>
                                    <td>1659</td>
                                    <td>5743</td>
                                    <td>1293</td>
                                    <td>4809</td>
                                    <td>3023</td>
                                </tr>
                                <tr>
                                    <td class="keycardfond">5</td>
                                    <td>2547</td>
                                    <td>6065</td>
                                    <td>2349</td>
                                    <td>8403</td>
                                    <td>3863</td>
                                    <td>6117</td>
                                </tr>
                            </table>
                            <div id="content_footer">
                                <input type="submit" name="btn_gen" value="Régénérer" class="arrowdark"/>
                                <input type="submit" name="btn_senddns" value="Mise à jour serveur" class="arrowdark"/>
                                <script language="javascript">
                                    <!-- 
                                    function popupcentree(page, largeur, hauteur, options) {
                                        var top = (screen.height - hauteur) / 2;
                                        var left = (screen.width - largeur) / 2;
                                        window.open(page, "", "top=" + top + ",left=" + left + ",width=" + largeur + ",height=" + hauteur + "," + options);
                                    }
                                    --> 
                                </script>
                                <input type="button" name="btn_print" value="Imprimer" class="arrowdark" onClick='popupcentree("u_print.htm",320,260,"menubar=no,scrollbars=no,statusbar=no");'>
                            </div>
                        </form>
                    </div>
                </div>
                <!--content -->
                <div id="spacer">
                <!-- -->
                <!--[if IE]>&nbsp;
          <![endif]-->
                </div>
                <div id="menu_footer">Copyright &copy;2013 Somfy
        </div>
            </div>
            <!-- fond -->
        </div>
        <!-- page -->
    </body>
</html>
